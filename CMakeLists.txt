cmake_minimum_required(VERSION 3.10)
project(blender-draco-exporter)
set(CMAKE_POSITION_INDEPENDENT_CODE ON)
set(CMAKE_CXX_STANDARD 14)

set(CMAKE_LIBRARY_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin/2.80/python/lib/python3.7)

# Build Draco.
add_subdirectory(draco EXCLUDE_FROM_ALL)

# Build blender-draco-exporter DLL.
add_library(${PROJECT_NAME} SHARED src/draco-compressor.cpp src/draco-compressor.h)

target_include_directories(${PROJECT_NAME} PUBLIC
	draco/src
	# Inlcude "draco/draco_features.h", which is generated by CMake.
	${CMAKE_BINARY_DIR}
)

target_link_libraries(${PROJECT_NAME} PUBLIC draco)

# Required because we are building a DLL.
set_property(TARGET ${PROJECT_NAME} PROPERTY POSITION_INDEPENDENT_CODE ON)
